var $=class M extends Error{static kind="ClerkError";clerkError=!0;code;longMessage;docsUrl;cause;get name(){return this.constructor.name}constructor(t){super(new.target.formatMessage(new.target.kind,t.message,t.code,t.docsUrl),{cause:t.cause}),Object.setPrototypeOf(this,M.prototype),this.code=t.code,this.docsUrl=t.docsUrl,this.longMessage=t.longMessage,this.cause=t.cause}toString(){return`[${this.name}]
Message:${this.message}`}static formatMessage(t,r,s,n){const o="Clerk:",i=new RegExp(o.replace(" ","\\s*"),"i");return r=r.replace(i,""),r=`${o} ${r.trim()}

(code="${s}")

`,n&&(r+=`

Docs: ${n}`),r}};const z=Object.freeze({InvalidProxyUrlErrorMessage:"The proxyUrl passed to Clerk is invalid. The expected value for proxyUrl is an absolute URL or a relative path with a leading '/'. (key={{url}})",InvalidPublishableKeyErrorMessage:"The publishableKey passed to Clerk is invalid. You can get your Publishable key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",MissingPublishableKeyErrorMessage:"Missing publishableKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingSecretKeyErrorMessage:"Missing secretKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingClerkProvider:"{{source}} can only be used within the <ClerkProvider /> component. Learn more: https://clerk.com/docs/components/clerk-provider"});function K({packageName:e,customMessages:t}){let r=e;function s(o,i){if(!i)return`${r}: ${o}`;let a=o;const u=o.matchAll(/{{([a-zA-Z0-9-_]+)}}/g);for(const l of u){const c=(i[l[1]]||"").toString();a=a.replace(`{{${l[1]}}}`,c)}return`${r}: ${a}`}const n={...z,...t};return{setPackageName({packageName:o}){return typeof o=="string"&&(r=o),this},setMessages({customMessages:o}){return Object.assign(n,o||{}),this},throwInvalidPublishableKeyError(o){throw new Error(s(n.InvalidPublishableKeyErrorMessage,o))},throwInvalidProxyUrl(o){throw new Error(s(n.InvalidProxyUrlErrorMessage,o))},throwMissingPublishableKeyError(){throw new Error(s(n.MissingPublishableKeyErrorMessage))},throwMissingSecretKeyError(){throw new Error(s(n.MissingSecretKeyErrorMessage))},throwMissingClerkProviderError(o){throw new Error(s(n.MissingClerkProvider,o))},throw(o){throw new Error(s(o))}}}var g=class R extends ${static kind="ClerkRuntimeError";clerkRuntimeError=!0;constructor(t,r){super({...r,message:t}),Object.setPrototypeOf(this,R.prototype)}};const V={strict_mfa:{afterMinutes:10,level:"multi_factor"},strict:{afterMinutes:10,level:"second_factor"},moderate:{afterMinutes:60,level:"second_factor"},lax:{afterMinutes:1440,level:"second_factor"}},j=new Set(["first_factor","second_factor","multi_factor"]),F=new Set(["strict_mfa","strict","moderate","lax"]),B=e=>typeof e=="number"&&e>0,N=e=>j.has(e),W=e=>F.has(e),h=e=>e.replace(/^(org:)*/,"org:"),Y=(e,t)=>{const{orgId:r,orgRole:s,orgPermissions:n}=t;return!e.role&&!e.permission||!r||!s||!n?null:e.permission?n.includes(h(e.permission)):e.role?h(s)===h(e.role):null},m=(e,t)=>{const{org:r,user:s}=H(e),[n,o]=t.split(":"),i=o||n;return n==="org"?r.includes(i):n==="user"?s.includes(i):[...r,...s].includes(i)},J=(e,t)=>{const{features:r,plans:s}=t;return e.feature&&r?m(r,e.feature):e.plan&&s?m(s,e.plan):null},H=e=>{const t=e?e.split(",").map(r=>r.trim()):[];return{org:t.filter(r=>r.split(":")[0].includes("o")).map(r=>r.split(":")[1]),user:t.filter(r=>r.split(":")[0].includes("u")).map(r=>r.split(":")[1])}},G=e=>{if(!e)return!1;const t=n=>typeof n=="string"?V[n]:n,r=typeof e=="string"&&W(e),s=typeof e=="object"&&N(e.level)&&B(e.afterMinutes);return r||s?t.bind(null,e):!1},X=(e,{factorVerificationAge:t})=>{if(!e.reverification||!t)return null;const r=G(e.reverification);if(!r)return null;const{level:s,afterMinutes:n}=r(),[o,i]=t,a=o!==-1?n>o:null,u=i!==-1?n>i:null;switch(s){case"first_factor":return a;case"second_factor":return i!==-1?u:a;case"multi_factor":return i===-1?a:a&&u}},Ce=e=>t=>{if(!e.userId)return!1;const r=J(t,e),s=Y(t,e),n=X(t,e);return[r||s,n].some(o=>o===null)?[r||s,n].some(o=>o===!0):[r||s,n].every(o=>o===!0)},Ae=({authObject:{sessionId:e,sessionStatus:t,userId:r,actor:s,orgId:n,orgRole:o,orgSlug:i,signOut:a,getToken:u,has:l,sessionClaims:c},options:{treatPendingAsSignedOut:d=!0}})=>{if(e===void 0&&r===void 0)return{isLoaded:!1,isSignedIn:void 0,sessionId:e,sessionClaims:void 0,userId:r,actor:void 0,orgId:void 0,orgRole:void 0,orgSlug:void 0,has:void 0,signOut:a,getToken:u};if(e===null&&r===null)return{isLoaded:!0,isSignedIn:!1,sessionId:e,userId:r,sessionClaims:null,actor:null,orgId:null,orgRole:null,orgSlug:null,has:()=>!1,signOut:a,getToken:u};if(d&&t==="pending")return{isLoaded:!0,isSignedIn:!1,sessionId:null,userId:null,sessionClaims:null,actor:null,orgId:null,orgRole:null,orgSlug:null,has:()=>!1,signOut:a,getToken:u};if(e&&c&&r&&n&&o)return{isLoaded:!0,isSignedIn:!0,sessionId:e,sessionClaims:c,userId:r,actor:s||null,orgId:n,orgRole:o,orgSlug:i||null,has:l,signOut:a,getToken:u};if(e&&c&&r&&!n)return{isLoaded:!0,isSignedIn:!0,sessionId:e,sessionClaims:c,userId:r,actor:s||null,orgId:null,orgRole:null,orgSlug:null,has:l,signOut:a,getToken:u}},q=[".lcl.dev",".stg.dev",".lclstage.dev",".stgstage.dev",".dev.lclclerk.com",".stg.lclclerk.com",".accounts.lclclerk.com","accountsstage.dev","accounts.dev"],P=e=>typeof atob<"u"&&typeof atob=="function"?atob(e):typeof global<"u"&&global.Buffer?new global.Buffer(e,"base64").toString():e,C="pk_live_",Z="pk_test_";function A(e){if(!e.endsWith("$"))return!1;const t=e.slice(0,-1);return t.includes("$")?!1:t.includes(".")}function E(e,t={}){if(e=e||"",!e||!b(e)){if(t.fatal&&!e)throw new Error("Publishable key is missing. Ensure that your publishable key is correctly configured. Double-check your environment configuration for your keys, or access them here: https://dashboard.clerk.com/last-active?path=api-keys");if(t.fatal&&!b(e))throw new Error("Publishable key not valid.");return null}const r=e.startsWith(C)?"production":"development";let s;try{s=P(e.split("_")[2])}catch{if(t.fatal)throw new Error("Publishable key not valid: Failed to decode key.");return null}if(!A(s)){if(t.fatal)throw new Error("Publishable key not valid: Decoded key has invalid format.");return null}let n=s.slice(0,-1);return t.proxyUrl?n=t.proxyUrl:r!=="development"&&t.domain&&t.isSatellite&&(n=`clerk.${t.domain}`),{instanceType:r,frontendApi:n}}function b(e=""){try{if(!(e.startsWith(C)||e.startsWith(Z)))return!1;const t=e.split("_");if(t.length!==3)return!1;const r=t[2];return r?A(P(r)):!1}catch{return!1}}function Q(){const e=new Map;return{isDevOrStagingUrl:t=>{if(!t)return!1;const r=typeof t=="string"?t:t.hostname;let s=e.get(r);return s===void 0&&(s=q.some(n=>r.endsWith(n)),e.set(r,s)),s}}}const ee="METHOD_CALLED",re=.1;function Oe(e,t){return{event:ee,eventSamplingRate:re,payload:{method:e,...t}}}const te=()=>{try{return!1}catch{}return!1},ne=()=>{try{return!1}catch{}return!1},se=()=>{try{return!0}catch{}return!1},v=new Set,Le=(e,t,r)=>{const s=ne()||se(),n=e;v.has(n)||s||(v.add(n),console.warn(`Clerk - DEPRECATION WARNING: "${e}" is deprecated and will be removed in the next major release.
${t}`))};function Ie(e,t,r){if(typeof e=="function")return e(t);if(typeof e<"u")return e;if(typeof r<"u")return r}const Te=e=>{te()&&console.error(`Clerk: ${e}`)},xe=(e,...t)=>{const r={...e};for(const s of t)delete r[s];return r},oe={initialDelay:125,maxDelayBetweenRetries:0,factor:2,shouldRetry:(e,t)=>t<5,retryImmediately:!1,jitter:!0},ie=100,O=async e=>new Promise(t=>setTimeout(t,e)),L=(e,t)=>t?e*(1+Math.random()):e,le=e=>{let t=0;const r=()=>{const s=e.initialDelay,n=e.factor;let o=s*Math.pow(n,t);return o=L(o,e.jitter),Math.min(e.maxDelayBetweenRetries||o,o)};return async()=>{await O(r()),t++}},ce=async(e,t={})=>{let r=0;const{shouldRetry:s,initialDelay:n,maxDelayBetweenRetries:o,factor:i,retryImmediately:a,jitter:u,onBeforeRetry:l}={...oe,...t},c=le({initialDelay:n,maxDelayBetweenRetries:o,factor:i,jitter:u});for(;;)try{return await e()}catch(d){if(r++,!s(d,r))throw d;l&&await l(r),a&&r===1?await O(L(ie,u)):await c()}},ae="loadScript cannot be called when document does not exist",ue="loadScript cannot be called without a src";async function de(e="",t){const{async:r,defer:s,beforeLoad:n,crossOrigin:o,nonce:i}=t||{};return ce(()=>new Promise((u,l)=>{e||l(new Error(ue)),(!document||!document.body)&&l(new Error(ae));const c=document.createElement("script");o&&c.setAttribute("crossorigin",o),c.async=r||!1,c.defer=s||!1,c.addEventListener("load",()=>{c.remove(),u(c)}),c.addEventListener("error",d=>{c.remove(),l(d.error??new Error(`failed to load script: ${e}`))}),c.src=e,c.nonce=i,n?.(c),document.body.appendChild(c)}),{shouldRetry:(u,l)=>l<=5})}function fe(e){return e?he(e)||I(e):!0}function he(e){return/^http(s)?:\/\//.test(e||"")}function I(e){return e.startsWith("/")}function ge(e){return e?I(e)?new URL(e,window.location.origin).toString():e:""}function pe(e){if(!e)return"";let t;if(e.match(/^(clerk\.)+\w*$/))t=/(clerk\.)*(?=clerk\.)/;else{if(e.match(/\.clerk.accounts/))return e;t=/^(clerk\.)*/gi}return`clerk.${e.replace(t,"")}`}const ye=(e,t="5.123.0")=>{if(e)return e;const r=me(t);return r?r==="snapshot"?"5.123.0":r:Ee(t)},me=e=>e.trim().replace(/^v/,"").match(/-(.+?)(\.|$)/)?.[1],Ee=e=>e.trim().replace(/^v/,"").split(".")[0],T="failed_to_load_clerk_js",be="failed_to_load_clerk_js_timeout",p="Failed to load Clerk",{isDevOrStagingUrl:ve}=Q(),x=K({packageName:"@clerk/shared"});function De(e){x.setPackageName({packageName:e})}function y(){if(typeof window>"u"||!window.Clerk)return!1;const e=window.Clerk;return typeof e=="object"&&typeof e.load=="function"}function we(e){if(typeof window>"u"||!window.performance)return!1;const t=performance.getEntriesByName(e,"resource");if(t.length===0)return!1;const r=t[t.length-1];return r.transferSize===0&&r.decodedBodySize===0&&(r.responseEnd===0||r.responseEnd>0&&r.responseStart>0||"responseStatus"in r&&(r.responseStatus>=400||r.responseStatus===0))}function w(e,t){return new Promise((r,s)=>{let n=!1;const o=(c,d)=>{clearTimeout(c),clearInterval(d)};t?.addEventListener("error",()=>{o(u,l),s(new g(p,{code:T}))});const i=()=>{n||y()&&(n=!0,o(u,l),r(null))},u=setTimeout(()=>{n||(n=!0,o(u,l),y()?r(null):s(new g(p,{code:be})))},e);i();const l=setInterval(()=>{if(n){clearInterval(l);return}i()},100)})}const Ue=async e=>{const t=e?.scriptLoadTimeout??15e3;if(y())return null;if(!e?.publishableKey)return x.throwMissingPublishableKeyError(),null;const r=ke(e),s=document.querySelector("script[data-clerk-js-script]");if(s)if(we(r))s.remove();else try{return await w(t,s),null}catch{s.remove()}const n=w(t);return de(r,{async:!0,crossOrigin:"anonymous",nonce:e.nonce,beforeLoad:Se(e)}).catch(o=>{throw new g(p+(o.message?`, ${o.message}`:""),{code:T,cause:o})}),n},ke=e=>{const{clerkJSUrl:t,clerkJSVariant:r,clerkJSVersion:s,proxyUrl:n,domain:o,publishableKey:i}=e;if(t)return t;let a="";n&&fe(n)?a=ge(n).replace(/http(s)?:\/\//,""):o&&!ve(E(i)?.frontendApi||"")?a=pe(o):a=E(i)?.frontendApi||"";const u=r?`${r.replace(/\.+$/,"")}.`:"",l=ye(s);return`https://${a}/npm/@clerk/clerk-js@${l}/dist/clerk.${u}browser.js`},_e=e=>{const t={};return e.publishableKey&&(t["data-clerk-publishable-key"]=e.publishableKey),e.proxyUrl&&(t["data-clerk-proxy-url"]=e.proxyUrl),e.domain&&(t["data-clerk-domain"]=e.domain),e.nonce&&(t.nonce=e.nonce),t},Se=e=>t=>{const r=_e(e);for(const s in r)t.setAttribute(s,r[s])},$e=(e,t,r)=>!e&&r?Me(r):Re(t),Me=e=>{const t=e.userId,r=e.user,s=e.sessionId,n=e.sessionStatus,o=e.sessionClaims;return{userId:t,user:r,sessionId:s,session:e.session,sessionStatus:n,sessionClaims:o,organization:e.organization,orgId:e.orgId,orgRole:e.orgRole,orgPermissions:e.orgPermissions,orgSlug:e.orgSlug,actor:e.actor,factorVerificationAge:e.factorVerificationAge}},Re=e=>{const t=e.user?e.user.id:e.user,r=e.user,s=e.session?e.session.id:e.session,n=e.session,o=e.session?.status,i=e.session?e.session.lastActiveToken?.jwt?.claims:null,a=e.session?e.session.factorVerificationAge:null,u=n?.actor,l=e.organization,c=e.organization?e.organization.id:e.organization,d=l?.slug,f=l&&r?.organizationMemberships?.find(U=>U.organization.id===c),D=f&&f.permissions;return{userId:t,user:r,sessionId:s,session:n,sessionStatus:o,sessionClaims:i,organization:l,orgId:c,orgRole:f&&f.role,orgSlug:d,orgPermissions:D,actor:u,factorVerificationAge:a}};function ze(){return typeof window<"u"}const k=(e,t,r,s,n)=>{const{notify:o}=n||{};let i=e.get(r);i||(i=[],e.set(r,i)),i.push(s),o&&t.has(r)&&s(t.get(r))},_=(e,t,r)=>(e.get(t)||[]).map(s=>s(r)),S=(e,t,r)=>{const s=e.get(t);s&&(r?s.splice(s.indexOf(r)>>>0,1):e.set(t,[]))},Pe=()=>{const e=new Map,t=new Map,r=new Map;return{on:(...n)=>k(e,t,...n),prioritizedOn:(...n)=>k(r,t,...n),emit:(n,o)=>{t.set(n,o),_(r,n,o),_(e,n,o)},off:(...n)=>S(e,...n),prioritizedOff:(...n)=>S(r,...n),internal:{retrieveListeners:n=>e.get(n)||[]}}},Ke={Status:"status"},Ve=()=>Pe();export{Ve as a,K as b,Ce as c,Le as d,Oe as e,Ke as f,Ue as g,Ie as h,ze as i,b as j,$e as k,Te as l,Ae as r,De as s,xe as w};
